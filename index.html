<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Office Task Tracker</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1000px;
        margin: 30px auto;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 10px;
        background-color: #fafafa;
      }

      h1 {
        text-align: center;
        color: #2c3e50;
      }

      form {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 10px;
        align-items: end;
        margin-bottom: 25px;
      }

      label {
        display: block;
        font-weight: bold;
        font-size: 13px;
        margin-bottom: 4px;
        color: #34495e;
      }

      input,
      select,
      textarea,
      button {
        padding: 8px;
        font-size: 14px;
        border: 1px solid #ccc;
        border-radius: 5px;
        width: 100%;
      }

      textarea {
        grid-column: span 6;
        min-height: 50px;
      }

      button {
        background-color: #3498db;
        color: white;
        font-weight: bold;
        cursor: pointer;
        grid-column: span 6;
      }

      button:hover {
        background-color: #2980b9;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        font-size: 14px;
      }

      th,
      td {
        padding: 10px;
        border: 1px solid #ddd;
        text-align: left;
      }

      th {
        background-color: #3498db;
        color: white;
        text-align: center;
      }

      tr:nth-child(even) {
        background-color: #f2f2f2;
      }

      tr:hover {
        background-color: #eaf3fc;
      }
    </style>
  </head>
  <body>
    <h1>Office Task Tracker</h1>

    <form id="taskForm">
      <div>
        <label for="assignedTo">Assigned To</label>
        <select id="assignedTo">
          <option value="Dennis Ebora">Dennis Ebora</option>
          <option value="Van Lagaras">Van Lagaras</option>
          <option value="Van/Dennis">Van/Dennis</option>
          <option value="Edmar Padayhag">Edmar Padayhag</option>
        </select>
      </div>

      <div>
        <label for="task">Task</label>
        <input type="text" id="task" placeholder="Task name" required />
      </div>

      <div>
        <label for="startDate">Start Date</label>
        <input type="date" id="startDate" required />
      </div>

      <div>
        <label for="dueDate">Due Date</label>
        <input type="date" id="dueDate" required />
      </div>

      <div>
        <label for="status">Status</label>
        <select id="status">
          <option value="In Progress">In Progress</option>
          <option value="Completed">Completed</option>
          <option value="Delayed">Delayed</option>
        </select>
      </div>

      <input type="text" id="remarks" placeholder="Remarks" />
      <button type="submit">Add Task</button>
    </form>

    <h2>Task List</h2>
    <table id="taskTable">
      <thead>
        <tr>
          <th>Task</th>
          <th>Assigned To</th>
          <th>Start Date</th>
          <th>Due Date</th>
          <th>Status</th>
          <th>Remarks</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td colspan="6" style="text-align: center">Loading tasks...</td>
        </tr>
      </tbody>
    </table>

    <script>
      const API_URL =
        "https://script.google.com/macros/s/AKfycbyCWs6tBsS_OXYbVRLBw9qxrrFKbhZK7gqW1NqwUtHd92C4sisgcw_87UWTuZGZ1_ct/exec";
      // --- Load tasks from Google Sheets ---
      async function loadTasks() {
        const res = await fetch(API_URL);
        const tasks = await res.json();

        const tableBody = document.getElementById("#taskTable tbody");
        tableBody.innerHTML = "";

        if (tasks.length === 0) {
          tableBody.innerHTML =
            '<tr><td colspan="6" style="text-align:center;">No tasks found.</td></tr>';
          return;
        }

        tasks.forEach((t) => {
          const row = document.createElement("tr");
          row.innerHTML = `
          <td>${t.task}</td>
          <td>${t.assignedTo}</td>
          <td>${t.startDate}</td>
          <td>${t.dueDate || "-"}</td>
          <td>${t.status}</td>
          <td>${t.remarks || "-"}</td>
        `;
          tableBody.appendChild(row);
        });
      }

      // --- Add a new task ---
      document
        .getElementById("taskForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();
          const assignedTo = document.getElementById("assignedTo").value;
          const task = document.getElementById("task").value;
          const startDate = document.getElementById("startDate").value;
          const dueDate = document.getElementById("dueDate").value;
          const status = document.getElementById("status").value;
          const remarks = document.getElementById("remarks").value;

          await fetch(API_URL, {
            method: "POST",
            body: JSON.stringify({
              assignedTo,
              task,
              startDate,
              dueDate,
              status,
              remarks,
            }),
          });

          e.target.reset();
          loadTasks();
        });

      // Initial load
      loadTasks();
    </script>
  </body>
</html>
